{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saque - Baldex</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap');

        :root {
            --cor-principal: #00b0ff;
            --cor-fundo: #0a192f;
            --cor-card: #112240;
            --cor-texto: #e6f1ff; 
            --cor-texto-secundario: #8892b0;
            --cor-borda: #233554;
            --cor-sucesso: #64ffda;
            --christmas-red: #d42426;
            --primary-gold: #ffd700;
        }

        body {
            background-color: var(--cor-fundo);
            color: var(--cor-texto);
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            text-align: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Cabeçalho */
        .header { padding: 40px 20px 20px; text-align: center; position: relative; }
        .header h1 { 
            margin: 0; font-size: 2.5em; font-weight: 800; 
            background-image: linear-gradient(90deg, #ffd700, #ff8c00);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .back-button { position: absolute; left: 20px; top: 50px; color: var(--primary-gold); font-size: 1.5em; text-decoration: none; }

        .container {
            width: 90%; max-width: 450px; background: var(--cor-card);
            border-radius: 20px; border: 1px solid var(--cor-borda);
            padding: 30px; margin: 20px auto; box-sizing: border-box;
        }

        /* Estilo Natalino */
        #christmas-card {
            border: 2px solid var(--christmas-red);
            box-shadow: 0 0 20px rgba(212, 36, 38, 0.4);
            display: none; /* Oculto por padrão, ativado via JS */
        }

        .holiday-icon { width: 120px; margin-bottom: 20px; filter: drop-shadow(0 0 10px var(--primary-gold)); }
        
        .holiday-title { color: var(--primary-gold); font-weight: 800; font-size: 1.5em; margin-bottom: 15px; }
        
        .holiday-msg { 
            background: var(--christmas-red); color: white; padding: 15px; 
            border-radius: 15px; font-weight: 600; margin: 20px 0; line-height: 1.5;
        }

        .holiday-footer {
            border: 1px dashed var(--primary-gold); padding: 10px; border-radius: 10px;
            color: var(--primary-gold); font-size: 0.85em; font-weight: bold;
        }

        /* Neve */
        .snowflake {
            color: #fff; font-size: 1em; position: fixed; top: -10%; z-index: 9999;
            user-select: none; animation: fall 10s linear infinite, shake 3s ease-in-out infinite;
        }
        @keyframes fall { 0% { top: -10%; } 100% { top: 100%; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(50px); } }

        /* Elementos originais (ocultos hoje) */
        #withdrawSection, #historySection { display: none; }
        .current-balance { color: var(--cor-sucesso); background: rgba(100, 255, 218, 0.05); padding: 15px; border-radius: 15px; border: 1px dashed var(--cor-sucesso); margin-bottom: 20px; }
        .form-group { text-align: left; margin-bottom: 20px; }
        .form-group input { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid var(--cor-borda); background: var(--cor-fundo); color: white; box-sizing: border-box;}
        .submit-btn { width: 100%; background: linear-gradient(90deg, #00b0ff, #007bff); color: white; border: none; padding: 16px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .toggle-btn { background: none; color: var(--cor-principal); border: 1px solid var(--cor-principal); padding: 10px; border-radius: 10px; width: 100%; margin-bottom: 20px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="snowflake" style="left:5%">❅</div><div class="snowflake" style="left:25%; animation-delay:2s">❆</div>
    <div class="snowflake" style="left:45%; animation-delay:4s">❅</div><div class="snowflake" style="left:65%; animation-delay:1s">❆</div>
    <div class="snowflake" style="left:85%; animation-delay:3s">❅</div>

    <div class="header">
        <a href="{% url 'menu' %}" class="back-button"><i class="fas fa-chevron-left"></i></a>
        <h1>Baldex Saque</h1>
    </div>

    <div id="christmas-card" class="container">
        <img src="https://cdn-icons-png.flaticon.com/512/2360/2360822.png" class="holiday-icon" alt="Natal">
        <div class="holiday-title">FELIZ ANO NOVO!</div>
        
        <div class="holiday-msg">
            A equipe BALDEX deseja a todos os investidores um ano repleto de conquistas e prosperidade! ✨
        </div>

        <div class="holiday-footer">
            HOJE NÃO É DIA DE TRABALHO, SÓ AMANHÃ.
        </div>
    </div>

    <div id="withdrawSection" class="container">
        <button id="showHistoryBtn" class="toggle-btn"><i class="fas fa-history"></i> Histórico de Saques</button>
        <p class="current-balance">Saldo: {{ usuario.saldo_disponivel|floatformat:2 }} KZ</p>
        <form method="post" action="{% url 'saque' %}">
            {% csrf_token %}
            <div class="form-group">
                <label>Valor para retirar</label>
                <input type="number" name="amount" min="{{ SAQUE_MINIMO }}" step="0.01" placeholder="0.00" required>
            </div>
            <button type="submit" class="submit-btn" {% if not tem_detalhes_bancarios %}disabled{% endif %}>Confirmar Saque</button>
        </form>
    </div>

    <div id="historySection" class="container">
        <button id="showWithdrawBtn" class="toggle-btn">Voltar para Saque</button>
        <h2>Meu Histórico</h2>
        </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const hoje = new Date();
            const dia = hoje.getDate();
            const mes = hoje.getMonth() + 1;

            const christmasCard = document.getElementById('christmas-card');
            const withdrawSection = document.getElementById('withdrawSection');
            const historySection = document.getElementById('historySection');

            // SE FOR DIA 25/12
            if (dia === 25 && mes === 12) {
                christmasCard.style.display = 'block';
                withdrawSection.style.display = 'none';
                historySection.style.display = 'none';
            } else {
                // Lógica Normal
                christmasCard.style.display = 'none';
                withdrawSection.style.display = 'block';

                document.getElementById('showHistoryBtn').addEventListener('click', () => {
                    withdrawSection.style.display = 'none';
                    historySection.style.display = 'block';
                });

                document.getElementById('showWithdrawBtn').addEventListener('click', () => {
                    withdrawSection.style.display = 'block';
                    historySection.style.display = 'none';
                });
            }
        });
    </script>
</body>
</html>